---

# Domain Validation Playbook
- name: Domain Join Validation
  hosts: "{{ ansible_host | default('all_servers') }}"
  gather_facts: yes
  vars:
    config_domain_name: "{{ domain_name }}"
    config_domain_realm: "{{ domain_name | upper }}"
    config_domain_ou_linux: "{{ linux_ou | default('') }}"
    config_domain_ou_windows: "{{ windows_ou | default('') }}"
    config_vm_name: "{{ vm_name | default(inventory_hostname) }}"
    config_vm_ip: "{{ ansible_host | default('') }}"
    config_vm_os_type: "linux"
    config_vm_description: "Domain Join Validation"
    config_vm_network_dns_servers: "{{ dns_server | default('') }}"
    config_domain_join_packages: "realmd,sssd,oddjob-mkhomedir,samba-common-tools,krb5-workstation"

  tasks:
    - name: Display environment information
      debug:
        msg: |
          Configuration Loaded:
          Domain: {{ config_domain_name | default('NOT_SET') }}
          Admin User: {{ domain_admin_user | default('NOT_SET') }}
          System: {{ ansible_system | default('UNKNOWN') }}
          VM: {{ config_vm_name }} ({{ config_vm_ip }})
      tags: [validation, debug]
      when: debug_mode | default(false) | bool

    - name: Execute domain validation checks
      include_role:
        name: domain/join_validation
      tags: validation

